# æ—¶é—´æ’åºä¿®å¤æŠ¥å‘Š v2

**ä¿®å¤æ—¶é—´**: 2026-01-29
**ç‰ˆæœ¬**: v2ï¼ˆæ·»åŠ ç»“æŸæ—¶é—´æ’åºï¼‰
**çŠ¶æ€**: âœ… å·²å®Œæˆ

---

## ğŸ¯ æ–°éœ€æ±‚

### ç”¨æˆ·åé¦ˆçš„é—®é¢˜

**æ•°æ®ç¤ºä¾‹**ï¼ˆ17:00å¼€å§‹çš„å¤œå¸‚æ´»åŠ¨ï¼‰:
```
1. 17:00-23:00  å‘¨å…­å¤œå¸‚ (å¸‚é›†)
2. 17:00-22:00  å‘¨æ—¥å¤œå¸‚ (å¸‚é›†)
3. 17:00-00:00  é•¿åº·è·¯å¤œå¸‚ (å¸‚é›†)
4. 17:00-23:00  æ¸…è¿ˆå¤§å­¦å‰é—¨å¤œå¸‚ (å¸‚é›†)
```

**é—®é¢˜**: å½“å¼€å§‹æ—¶é—´ç›¸åŒæ—¶ï¼ˆéƒ½æ˜¯17:00ï¼‰ï¼Œåº”è¯¥æŒ‰**ç»“æŸæ—¶é—´**æ’åº

**ç‰¹æ®Šè¦æ±‚**: `00:00` åº”è¯¥è¢«å¤„ç†ä¸º `24:00`ï¼ˆæœ€æ™šï¼‰

---

## âœ… å®æ–½çš„ä¿®å¤

### 1. æ·»åŠ  `extractEndTime()` å‡½æ•°

**ä½ç½®**: `public/index.html` ç¬¬2546-2584è¡Œ

```javascript
/**
 * æå–æ—¶é—´çš„ç»“æŸéƒ¨åˆ†
 * @param {string} timeStr - æ—¶é—´å­—ç¬¦ä¸²ï¼Œå¦‚ "16:00-19:00"
 * @returns {object} - { hour, minute, isOvernight }
 */
function extractEndTime(timeStr) {
    if (!timeStr || timeStr === 'çµæ´»æ—¶é—´') {
        return { hour: 99, minute: 99, isOvernight: false, original: timeStr || 'çµæ´»æ—¶é—´' };
    }

    // æŸ¥æ‰¾ç»“æŸæ—¶é—´éƒ¨åˆ†ï¼ˆç¬¬äºŒä¸ªæ—¶é—´ï¼‰
    const parts = timeStr.split('-');
    if (parts.length >= 2) {
        const endTimeStr = parts[1].trim();
        const match = endTimeStr.match(/^(\d{1,2}):(\d{2})/);
        if (match) {
            let hour = parseInt(match[1], 10);
            let minute = parseInt(match[2], 10);
            let isOvernight = false;

            // ç‰¹æ®Šå¤„ç†ï¼š00:00 è¡¨ç¤ºå½“å¤©çš„24:00ï¼ˆæœ€æ™šï¼‰
            if (hour === 0 && minute === 0) {
                hour = 24;
                minute = 0;
                isOvernight = true;
            }

            return { hour, minute, isOvernight, original: endTimeStr };
        }
    }

    // å¦‚æœæ²¡æœ‰ç»“æŸæ—¶é—´ï¼ˆå•ä¸€æ—¶é—´ç‚¹ï¼‰ï¼Œè¿”å›å¼€å§‹æ—¶é—´
    const start = extractStartTime(timeStr);
    return { hour: start.hour, minute: start.minute, isOvernight: false, original: timeStr };
}
```

**å…³é”®é€»è¾‘**:
- âœ… æå–ç»“æŸæ—¶é—´ï¼ˆç¬¬äºŒä¸ªæ—¶é—´éƒ¨åˆ†ï¼‰
- âœ… `00:00` â†’ `24:00`ï¼ˆç‰¹æ®Šå¤„ç†ï¼‰
- âœ… å•ä¸€æ—¶é—´ç‚¹è¿”å›å¼€å§‹æ—¶é—´

### 2. æ›´æ–° `compareTimes()` å‡½æ•°

**ä½ç½®**: `public/index.html` ç¬¬2586-2624è¡Œ

**æ–°å¢æ’åºä¼˜å…ˆçº§3**:
```javascript
// ä¼˜å…ˆçº§1: æŒ‰å¼€å§‹æ—¶é—´æ’åº
if (extractedA.hour !== extractedB.hour) {
    return extractedA.hour - extractedB.hour;
}

// ä¼˜å…ˆçº§2: ç›¸åŒå¼€å§‹æ—¶é—´æ—¶ï¼Œå•ä¸€æ—¶é—´ç‚¹åœ¨å‰
const isRangeA = extractedA.original.includes('-');
const isRangeB = extractedB.original.includes('-');
if (isRangeA && !isRangeB) return 1;
if (!isRangeA && isRangeB) return -1;

// ä¼˜å…ˆçº§3: éƒ½æ˜¯æ—¶é—´æ®µï¼ŒæŒ‰ç»“æŸæ—¶é—´æ’åº
if (isRangeA && isRangeB) {
    const endA = extractEndTime(extractedA.original);
    const endB = extractEndTime(extractedB.original);

    // æŒ‰ç»“æŸæ—¶é—´æ’åºï¼ˆæ—©ç»“æŸçš„åœ¨å‰ï¼‰
    if (endA.hour !== endB.hour) {
        return endA.hour - endB.hour;
    }

    if (endA.minute !== endB.minute) {
        return endA.minute - endB.minute;
    }

    return 0; // ç»“æŸæ—¶é—´ä¹Ÿç›¸åŒï¼Œä¿æŒåŸé¡ºåº
}
```

---

## ğŸ“Š å®Œæ•´çš„æ’åºè§„åˆ™

### ä¸‰çº§æ’åºé€»è¾‘

```
ä¼˜å…ˆçº§1: å¼€å§‹æ—¶é—´ï¼ˆæ•°å­—ï¼‰
  9:00 < 10:00 < 16:00 < 17:00 < 19:00

ä¼˜å…ˆçº§2: æ—¶é—´ç±»å‹
  å•ä¸€æ—¶é—´ç‚¹ï¼ˆå¦‚ 17:00ï¼‰æ’åœ¨å‰é¢
  æ—¶é—´æ®µï¼ˆå¦‚ 17:00-22:00ï¼‰æ’åœ¨åé¢

ä¼˜å…ˆçº§3: ç»“æŸæ—¶é—´ï¼ˆæ•°å­—ï¼‰
  17:00-22:00 (22:00ç»“æŸ) â† æœ€æ—©
  17:00-23:00 (23:00ç»“æŸ)
  17:00-00:00 (24:00ç»“æŸ) â† æœ€æ™šï¼ˆ00:00è½¬ä¸º24:00ï¼‰

ä¼˜å…ˆçº§4: çµæ´»æ—¶é—´
  çµæ´»æ—¶é—´æ’åœ¨æœ€åï¼ˆ99:99ï¼‰
```

### ç‰¹æ®Šå¤„ç†

#### è·¨æ—¥æ—¶é—´ `00:00`

**è½¬æ¢è§„åˆ™**:
```
17:00-00:00 â†’ å¼€å§‹: 17:00, ç»“æŸ: 24:00
17:00-23:59 â†’ å¼€å§‹: 17:00, ç»“æŸ: 23:59
16:00-01:00 â†’ å¼€å§‹: 16:00, ç»“æŸ: 01:00
```

**æ’åºç¤ºä¾‹**:
```
17:00-22:00  (22:00) â† ç¬¬1
17:00-23:00  (23:00) â† ç¬¬2
17:00-00:00  (24:00) â† ç¬¬3ï¼ˆ00:00è½¬ä¸º24:00ï¼‰
```

---

## ğŸ§ª æµ‹è¯•éªŒè¯

### æ–°å¢æµ‹è¯•ç”¨ä¾‹

**æµ‹è¯•3.5: ç›¸åŒå¼€å§‹æ—¶é—´ï¼ˆæŒ‰ç»“æŸæ—¶é—´æ’åºï¼‰**

**è¾“å…¥æ•°æ®**:
```javascript
[
  { title: "å‘¨å…­å¤œå¸‚", time: "17:00-23:00" },
  { title: "å‘¨æ—¥å¤œå¸‚", time: "17:00-22:00" },
  { title: "é•¿åº·è·¯å¤œå¸‚", time: "17:00-00:00" },
  { title: "æ¸…è¿ˆå¤§å­¦å‰é—¨å¤œå¸‚", time: "17:00-23:00" }
]
```

**æœŸæœ›æ’åº**:
```
1. 17:00-22:00  å‘¨æ—¥å¤œå¸‚ (22:00ç»“æŸ)
2. 17:00-23:00  å‘¨å…­å¤œå¸‚ (23:00ç»“æŸ)
3. 17:00-23:00  æ¸…è¿ˆå¤§å­¦å‰é—¨å¤œå¸‚ (23:00ç»“æŸ)
4. 17:00-00:00  é•¿åº·è·¯å¤œå¸‚ (24:00ç»“æŸ)
```

**éªŒè¯ç‚¹**:
- âœ… 17:00-22:00 æ’ç¬¬1ï¼ˆ22:00æœ€æ—©ï¼‰
- âœ… 17:00-23:00 æ’ç¬¬2å’Œ3ï¼ˆ23:00ï¼‰
- âœ… 17:00-00:00 æ’ç¬¬4ï¼ˆ00:00è½¬ä¸º24:00ï¼Œæœ€æ™šï¼‰

---

## ğŸ“‹ æ’åºè§„åˆ™æ€»ç»“è¡¨

| å¼€å§‹æ—¶é—´ | ç±»å‹ | ç»“æŸæ—¶é—´ | æ’åºä¾æ® |
|---------|------|---------|---------|
| 9:00 | å•ä¸€ç‚¹ | - | 9:00 |
| 10:00 | èŒƒå›´ | 11:00 | 10:00ï¼ˆå¼€å§‹ï¼‰ |
| 16:00 | å•ä¸€ç‚¹ | - | 16:00 |
| 16:00 | èŒƒå›´ | 19:00 | 16:00ï¼ˆå¼€å§‹ï¼‰ |
| 17:00 | èŒƒå›´ | 22:00 | 17:00ï¼ˆå¼€å§‹ï¼‰ï¼Œ22:00ï¼ˆç»“æŸæ—©ï¼‰ |
| 17:00 | èŒƒå›´ | 23:00 | 17:00ï¼ˆå¼€å§‹ï¼‰ï¼Œ23:00ï¼ˆç»“æŸä¸­ï¼‰ |
| 17:00 | èŒƒå›´ | 00:00 | 17:00ï¼ˆå¼€å§‹ï¼‰ï¼Œ24:00ï¼ˆç»“æŸæœ€æ™šï¼‰|
| çµæ´» | - | - | 99:99ï¼ˆæœ€åï¼‰ |

---

## âœ… ä¿®å¤ç¡®è®¤

### ä¿®æ”¹çš„æ–‡ä»¶

1. **public/index.html**
   - âœ… ç¬¬2546-2584è¡Œ: æ·»åŠ  `extractEndTime()` å‡½æ•°
   - âœ… ç¬¬2586-2624è¡Œ: æ›´æ–° `compareTimes()` å‡½æ•°

2. **public/test-time-sorting.html**
   - âœ… æ›´æ–° `extractStartTime()` å’Œ `compareTimes()` å‡½æ•°
   - âœ… æ·»åŠ  `extractEndTime()` å‡½æ•°
   - âœ… æ·»åŠ æµ‹è¯•3.5: ç›¸åŒå¼€å§‹æ—¶é—´æŒ‰ç»“æŸæ—¶é—´æ’åº
   - âœ… æ›´æ–° `runAllTests()` åŒ…å«æ–°æµ‹è¯•

### æµ‹è¯•é¡µé¢

**è®¿é—®**: http://localhost:3000/test-time-sorting.html

**æµ‹è¯•ç”¨ä¾‹**: 6ä¸ªï¼ˆæ–°å¢1ä¸ªï¼‰
1. âœ… åŸºæœ¬æ’åºï¼ˆ16:00-19:00åœºæ™¯ï¼‰
2. âœ… 9:00 vs 10:00ï¼ˆå­—ç¬¦ä¸²æ¯”è¾ƒé—®é¢˜ï¼‰
3. âœ… ç›¸åŒå¼€å§‹æ—¶é—´ï¼ˆç‚¹ vs èŒƒå›´ï¼‰
4. âœ… **ç›¸åŒå¼€å§‹æ—¶é—´ï¼ˆæŒ‰ç»“æŸæ—¶é—´æ’åºï¼‰** â† æ–°å¢
5. âœ… çµæ´»æ—¶é—´æ’åº
6. âœ… çœŸå®æ•°æ®æµ‹è¯•

---

## ğŸ¯ é¢„æœŸæ•ˆæœ

### 17:00å¤œå¸‚æ´»åŠ¨çš„æ­£ç¡®æ’åº

```
æ’åºå‰ï¼ˆä¸ç¡®å®šï¼‰:
  Ã— 17:00-23:00ï¼ˆé¡ºåºéšæœºï¼‰
  Ã— 17:00-22:00
  Ã— 17:00-00:00
  Ã— 17:00-23:00

æ’åºåï¼ˆæ­£ç¡®ï¼‰:
  1. 17:00-22:00 å‘¨æ—¥å¤œå¸‚       â† 22:00ç»“æŸ
  2. 17:00-23:00 å‘¨å…­å¤œå¸‚       â† 23:00ç»“æŸ
  3. 17:00-23:00 æ¸…è¿ˆå¤§å­¦å‰é—¨å¤œå¸‚  â† 23:00ç»“æŸ
  4. 17:00-00:00 é•¿åº·è·¯å¤œå¸‚       â† 24:00ç»“æŸï¼ˆ00:00â†’24:00ï¼‰
```

---

## ğŸ“ å…³é”®æŠ€æœ¯ç‚¹

### 1. 00:00 çš„ç‰¹æ®Šå¤„ç†

**ä¸ºä»€ä¹ˆæ˜¯24:00?**
- `00:00` é€šå¸¸è¡¨ç¤º"å½“å¤©çš„ç»“æŸ"ï¼ˆåˆå¤œï¼‰
- åœ¨24å°æ—¶åˆ¶ä¸­ï¼Œ`00:00` = `24:00`
- `17:00-00:00` æ„å‘³ç€ä»17:00åˆ°å½“å¤©ç»“æŸ

**ä»£ç å®ç°**:
```javascript
if (hour === 0 && minute === 0) {
    hour = 24;      // 0:00 â†’ 24:00
    isOvernight = true;
}
```

### 2. ç»“æŸæ—¶é—´æå–

**æ­£åˆ™è¡¨è¾¾å¼**: `/^(\d{1,2}):(\d{2})/`

**ç¤ºä¾‹**:
- `17:00-22:00` â†’ `22:00`
- `17:00-00:00` â†’ `00:00` â†’ `24:00`
- `16:00-19:00` â†’ `19:00`

### 3. ä¸‰çº§ä¼˜å…ˆçº§æ’åº

```javascript
// ä¼˜å…ˆçº§1: å¼€å§‹æ—¶é—´
if (å¼€å§‹æ—¶é—´ä¸åŒ) {
    return å¼€å§‹æ—¶é—´A - å¼€å§‹æ—¶é—´B;
}

// ä¼˜å…ˆçº§2: ç±»å‹ï¼ˆç‚¹ vs èŒƒå›´ï¼‰
if (ä¸€ä¸ªæ˜¯ç‚¹ && ä¸€ä¸ªæ˜¯èŒƒå›´) {
    return ç‚¹åœ¨å‰ï¼ŒèŒƒå›´åœ¨å;
}

// ä¼˜å…ˆçº§3: ç»“æŸæ—¶é—´ï¼ˆä»…å½“éƒ½æ˜¯èŒƒå›´æ—¶ï¼‰
if (éƒ½æ˜¯èŒƒå›´) {
    return ç»“æŸæ—¶é—´A - ç»“æŸæ—¶é—´B;
}
```

---

## âœ… ä¿®å¤éªŒè¯

- âœ… æ·»åŠ  `extractEndTime()` å‡½æ•°
- âœ… æ›´æ–° `compareTimes()` å‡½æ•°ï¼ˆæ·»åŠ ä¼˜å…ˆçº§3ï¼‰
- âœ… ç‰¹æ®Šå¤„ç† `00:00` â†’ `24:00`
- âœ… æ›´æ–°æµ‹è¯•é¡µé¢ï¼ˆæ·»åŠ æµ‹è¯•3.5ï¼‰
- âœ… ä¸‰Tabæ’åºé€»è¾‘ä¿æŒä¸€è‡´

**ä¿®å¤å®Œæˆæ—¶é—´**: 2026-01-29
**ç‰ˆæœ¬**: v2
**çŠ¶æ€**: âœ… å·²å®Œæˆ

---

**ç«‹å³éªŒè¯**: è®¿é—® http://localhost:3000/test-time-sorting.html æŸ¥çœ‹æµ‹è¯•ç»“æœï¼
