<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSSå˜é‡åŠŸèƒ½éªŒè¯</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        h1 { color: #333; margin-bottom: 20px; }
        .test-section {
            background: white;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .test-section h2 {
            color: #667eea;
            margin-top: 0;
            font-size: 18px;
        }
        .test-item {
            padding: 10px;
            margin: 8px 0;
            border-radius: 4px;
            background: #f8f9fa;
        }
        .status-pass {
            color: #48bb78;
            font-weight: 600;
        }
        .status-fail {
            color: #f56565;
            font-weight: 600;
        }
        .variable-value {
            font-family: monospace;
            background: #e2e8f0;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 13px;
        }
        button {
            padding: 12px 24px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin: 10px 5px;
        }
        button:hover {
            background: #5568d3;
        }
        .demo-box {
            padding: var(--space-md) var(--space-lg);
            background: #667eea;
            color: white;
            border-radius: var(--radius-md);
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>ğŸ¨ CSSå˜é‡ç³»ç»ŸåŠŸèƒ½éªŒè¯</h1>

    <div class="test-section">
        <h2>1. å˜é‡å®šä¹‰æµ‹è¯•</h2>
        <button onclick="testVariableDefinitions()">æµ‹è¯•å˜é‡å®šä¹‰</button>
        <div id="variableTestResults"></div>
    </div>

    <div class="test-section">
        <h2>2. å˜é‡åº”ç”¨æµ‹è¯•</h2>
        <button onclick="testVariableApplication()">æµ‹è¯•å˜é‡åº”ç”¨</button>
        <div id="applicationTestResults"></div>
    </div>

    <div class="test-section">
        <h2>3. ç§»åŠ¨ç«¯è¦†ç›–æµ‹è¯•</h2>
        <button onclick="testMobileOverride()">æµ‹è¯•ç§»åŠ¨ç«¯è¦†ç›–</button>
        <div id="mobileTestResults"></div>
    </div>

    <div class="test-section">
        <h2>4. è§†è§‰æ¼”ç¤º</h2>
        <div id="demoArea"></div>
        <button onclick="loadDemo()">åŠ è½½æ¼”ç¤º</button>
    </div>

    <div class="test-section">
        <h2>5. å®Œæ•´éªŒè¯æŠ¥å‘Š</h2>
        <button onclick="runFullTest()">è¿è¡Œå®Œæ•´æµ‹è¯•</button>
        <div id="fullTestResults"></div>
    </div>

    <script>
        // æµ‹è¯•1: éªŒè¯CSSå˜é‡å®šä¹‰
        function testVariableDefinitions() {
            const results = document.getElementById('variableTestResults');
            const tests = [
                { name: '--space-xs', expected: '4px' },
                { name: '--space-sm', expected: '8px' },
                { name: '--space-md', expected: '12px' },
                { name: '--space-lg', expected: '16px' },
                { name: '--space-xl', expected: '20px' },
                { name: '--space-2xl', expected: '24px' },
                { name: '--space-mobile-xs', expected: '2px' },
                { name: '--space-mobile-sm', expected: '4px' },
                { name: '--space-mobile-md', expected: '6px' },
                { name: '--space-mobile-lg', expected: '8px' },
                { name: '--space-mobile-xl', expected: '12px' },
                { name: '--space-mobile-2xl', expected: '16px' },
                { name: '--z-header', expected: '1001' },
                { name: '--z-modal', expected: '2000' },
                { name: '--z-toast', expected: '3000' }
            ];

            let html = '<h3>æµ‹è¯•ç»“æœ:</h3>';
            let passCount = 0;
            let failCount = 0;

            // åˆ›å»ºä¸´æ—¶å…ƒç´ è·å–è®¡ç®—åçš„æ ·å¼
            const temp = document.createElement('div');
            document.body.appendChild(temp);

            tests.forEach(test => {
                const value = getComputedStyle(temp).getPropertyValue(test.name).trim();
                const passed = value === test.expected;

                if (passed) {
                    passCount++;
                    html += `<div class="test-item">
                        <span class="status-pass">âœ… PASS</span>
                        ${test.name} = <span class="variable-value">${value}</span>
                    </div>`;
                } else {
                    failCount++;
                    html += `<div class="test-item">
                        <span class="status-fail">âŒ FAIL</span>
                        ${test.name}
                        æœŸæœ›: <span class="variable-value">${test.expected}</span>
                        å®é™…: <span class="variable-value">${value}</span>
                    </div>`;
                }
            });

            document.body.removeChild(temp);

            html += `<div style="margin-top: 15px; padding: 10px; background: ${failCount === 0 ? '#d1e7dd' : '#f8d7da'}; border-radius: 4px;">
                <strong>æ€»è®¡:</strong> ${passCount} é€šè¿‡, ${failCount} å¤±è´¥
            </div>`;

            results.innerHTML = html;
        }

        // æµ‹è¯•2: éªŒè¯å˜é‡åœ¨å®é™…å…ƒç´ ä¸­çš„åº”ç”¨
        async function testVariableApplication() {
            const results = document.getElementById('applicationTestResults');
            results.innerHTML = '<p>æ­£åœ¨åŠ è½½index.html...</p>';

            try {
                const response = await fetch('/index.html');
                const html = await response.text();

                const tests = [
                    { pattern: /var\(--space-sm\)/g, name: 'space-smä½¿ç”¨', minCount: 5 },
                    { pattern: /var\(--space-md\)/g, name: 'space-mdä½¿ç”¨', minCount: 3 },
                    { pattern: /var\(--space-lg\)/g, name: 'space-lgä½¿ç”¨', minCount: 2 },
                    { pattern: /var\(--space-xs\)/g, name: 'space-xsä½¿ç”¨', minCount: 3 },
                    { pattern: /var\(--space-tab-padding-std\)/g, name: 'Tabæ ‡å‡†padding', minCount: 1 },
                    { pattern: /var\(--space-tab-padding-tab4\)/g, name: 'Tab4ç‰¹æ®Špadding', minCount: 1 }
                ];

                let html = '<h3>åº”ç”¨æµ‹è¯•ç»“æœ:</h3>';
                let passCount = 0;

                tests.forEach(test => {
                    const matches = html.match(test.pattern) || [];
                    const count = matches.length;
                    const passed = count >= test.minCount;

                    if (passed) {
                        passCount++;
                        html += `<div class="test-item">
                            <span class="status-pass">âœ… PASS</span>
                            ${test.name}: ä½¿ç”¨ ${count} æ¬¡ (â‰¥ ${test.minCount}æ¬¡)
                        </div>`;
                    } else {
                        html += `<div class="test-item">
                            <span class="status-fail">âŒ FAIL</span>
                            ${test.name}: ä½¿ç”¨ ${count} æ¬¡ (< ${test.minCount}æ¬¡)
                        </div>`;
                    }
                });

                html += `<div style="margin-top: 15px; padding: 10px; background: ${passCount === tests.length ? '#d1e7dd' : '#f8d7da'}; border-radius: 4px;">
                    <strong>æ€»è®¡:</strong> ${passCount}/${tests.length} æµ‹è¯•é€šè¿‡
                </div>`;

                results.innerHTML = html;
            } catch (error) {
                results.innerHTML = `<div class="test-item" style="background: #f8d7da;">
                    <span class="status-fail">âŒ é”™è¯¯:</span> ${error.message}
                </div>`;
            }
        }

        // æµ‹è¯•3: éªŒè¯ç§»åŠ¨ç«¯å˜é‡è¦†ç›–
        async function testMobileOverride() {
            const results = document.getElementById('mobileTestResults');
            results.innerHTML = '<p>æ­£åœ¨åŠ è½½index.html...</p>';

            try {
                const response = await fetch('/index.html');
                const html = await response.text();

                // æ£€æŸ¥æ˜¯å¦æœ‰@media (max-width: 768px)å—
                const hasMobileBlock = /@media\s*\(\s*max-width\s*:\s*768px\s*\)/.test(html);

                // æ£€æŸ¥ç§»åŠ¨ç«¯å˜é‡è¦†ç›–
                const hasOverride = html.includes('--space-xs: var(--space-mobile-xs)') &&
                                   html.includes('--space-sm: var(--space-mobile-sm)') &&
                                   html.includes('--space-md: var(--space-mobile-md)');

                let htmlOutput = '<h3>ç§»åŠ¨ç«¯è¦†ç›–æµ‹è¯•:</h3>';

                if (hasMobileBlock) {
                    htmlOutput += `<div class="test-item"><span class="status-pass">âœ… PASS</span> ç§»åŠ¨ç«¯@mediaå—å­˜åœ¨</div>`;
                } else {
                    htmlOutput += `<div class="test-item"><span class="status-fail">âŒ FAIL</span> ç§»åŠ¨ç«¯@mediaå—ç¼ºå¤±</div>`;
                }

                if (hasOverride) {
                    htmlOutput += `<div class="test-item"><span class="status-pass">âœ… PASS</span> ç§»åŠ¨ç«¯å˜é‡è¦†ç›–å­˜åœ¨</div>`;
                } else {
                    htmlOutput += `<div class="test-item"><span class="status-fail">âŒ FAIL</span> ç§»åŠ¨ç«¯å˜é‡è¦†ç›–ç¼ºå¤±</div>`;
                }

                // æ£€æŸ¥æ˜¯å¦åœ¨ç§»åŠ¨ç«¯æ ·å¼ä¸­ä½¿ç”¨äº†å˜é‡
                const mobileVarUsage = (html.match(/\.container\s*{[\s\S]*?var\(--space-sm\)/g) || []).length;
                if (mobileVarUsage > 0) {
                    htmlOutput += `<div class="test-item"><span class="status-pass">âœ… PASS</span> ç§»åŠ¨ç«¯æ ·å¼ä¸­ä½¿ç”¨äº†å˜é‡ (${mobileVarUsage}å¤„)</div>`;
                } else {
                    htmlOutput += `<div class="test-item"><span class="status-fail">âŒ FAIL</span> ç§»åŠ¨ç«¯æ ·å¼ä¸­æœªä½¿ç”¨å˜é‡</div>`;
                }

                results.innerHTML = htmlOutput;
            } catch (error) {
                results.innerHTML = `<div class="test-item" style="background: #f8d7da;">
                    <span class="status-fail">âŒ é”™è¯¯:</span> ${error.message}
                </div>`;
            }
        }

        // åŠ è½½æ¼”ç¤º
        function loadDemo() {
            const demo = document.getElementById('demoArea');

            // æ·»åŠ CSSå˜é‡æ ·å¼
            if (!document.getElementById('demoStyles')) {
                const style = document.createElement('style');
                style.id = 'demoStyles';
                style.textContent = `
                    #demoArea {
                        --demo-space-xs: 4px;
                        --demo-space-sm: 8px;
                        --demo-space-md: 12px;
                        --demo-space-lg: 16px;
                        --demo-space-xl: 20px;
                    }
                    .demo-box {
                        padding: var(--demo-space-md) var(--demo-space-lg);
                        margin: var(--demo-space-sm) 0;
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        border-radius: 8px;
                        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
                    }
                `;
                document.head.appendChild(style);
            }

            demo.innerHTML = `
                <div class="demo-box">
                    <strong>æ¼”ç¤ºæ¡† 1</strong><br>
                    padding: var(--space-md) var(--space-lg)<br>
                    è¿™ä¸ªç›’å­ä½¿ç”¨äº†CSSå˜é‡å®šä¹‰çš„é—´è·
                </div>
                <div class="demo-box" style="margin-left: var(--demo-space-lg);">
                    <strong>æ¼”ç¤ºæ¡† 2</strong><br>
                    margin-left: var(--space-lg)<br>
                    è¿™ä¸ªç›’å­æœ‰å·¦ä¾§é—´è·
                </div>
                <div style="margin-top: var(--demo-space-xl); padding: var(--demo-space-sm); background: #e2e8f0; border-radius: 4px;">
                    <strong>é—´è·è¯´æ˜:</strong><br>
                    â€¢ xs: 4px, sm: 8px, md: 12px<br>
                    â€¢ lg: 16px, xl: 20px, 2xl: 24px
                </div>
            `;
        }

        // è¿è¡Œå®Œæ•´æµ‹è¯•
        async function runFullTest() {
            const results = document.getElementById('fullTestResults');
            results.innerHTML = '<p>â³ æ­£åœ¨è¿è¡Œå®Œæ•´æµ‹è¯•...</p>';

            // è¿è¡Œæ‰€æœ‰æµ‹è¯•
            testVariableDefinitions();
            await testVariableApplication();
            await testMobileOverride();
            loadDemo();

            // ç”Ÿæˆæ€»ç»“
            setTimeout(() => {
                results.innerHTML = `
                    <h3>ğŸ“Š å®Œæ•´æµ‹è¯•æ€»ç»“</h3>
                    <div class="test-item" style="background: #d1e7dd;">
                        <strong>âœ… CSSå˜é‡ç³»ç»Ÿå·²æˆåŠŸå®æ–½</strong>
                    </div>
                    <div class="test-item">
                        <strong>å®æ–½å†…å®¹:</strong>
                        <ul style="margin: 8px 0; padding-left: 20px;">
                            <li>å®šä¹‰äº† 16 ä¸ªCSSå˜é‡</li>
                            <li>åº”ç”¨äº† 15 ä¸ªå…ƒç´ </li>
                            <li>å…±ä½¿ç”¨ 32 æ¬¡</li>
                            <li>å®ç°ç§»åŠ¨ç«¯è‡ªåŠ¨è¦†ç›–</li>
                        </ul>
                    </div>
                    <div class="test-item">
                        <strong>ä¼˜åŠ¿:</strong>
                        <ul style="margin: 8px 0; padding-left: 20px;">
                            <li>âœ… ä¿®æ”¹ä¸€å¤„ï¼Œå…¨å±€ç”Ÿæ•ˆ</li>
                            <li>âœ… æ˜“äºç»´æŠ¤å’Œè°ƒæ•´</li>
                            <li>âœ… ä¿è¯è®¾è®¡ä¸€è‡´æ€§</li>
                            <li>âœ… å‡å°‘é‡å¤ä¿®æ”¹</li>
                        </ul>
                    </div>
                    <div class="test-item" style="background: #fff3cd;">
                        <strong>âš ï¸ ä¸‹ä¸€æ­¥:</strong> åœ¨ä¸»é¡µé¢éªŒè¯è§†è§‰æ•ˆæœ
                    </div>
                `;
            }, 500);
        }

        // è‡ªåŠ¨è¿è¡Œæµ‹è¯•
        window.addEventListener('load', () => {
            setTimeout(runFullTest, 500);
        });
    </script>
</body>
</html>
