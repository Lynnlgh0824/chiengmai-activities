# 活动暂停状态方案 - 简化版

## 📋 方案概述

**核心思路**：通过后台管理系统控制活动状态，前端根据状态过滤展示

**实施日期**：2026-01-27

---

## 🎯 数据结构

### 字段设计

```json
{
  "status": "进行中" | "draft" | "suspended",
  "suspensionNote": "简短备注（可选）"
}
```

### 状态说明

| 状态值 | 前端展示 | 适用场景 | 备注 |
|--------|---------|---------|------|
| `进行中` | ✅ 正常展示 | 活动正常运营 | 默认状态 |
| `draft` | ❌ 完全隐藏 | 临时隐藏、未发布 | 管理员手动控制 |
| `suspended` | ❌ 完全隐藏 | 临时暂停、关闭 | 需配合suspensionNote说明 |

---

## 💡 使用场景

### 场景1：活动因花卉节暂停（当前案例）

**操作**：
```json
{
  "status": "suspended",
  "suspensionNote": "花卉节期间公园关闭（1月26日-2月15日），预计2月16日恢复"
}
```

**恢复操作**：
```json
{
  "status": "进行中",
  "suspensionNote": ""  // 清空备注
}
```

---

### 场景2：新活动筹备中

**操作**：
```json
{
  "status": "draft",
  "suspensionNote": "活动筹备中，预计3月开放"
}
```

**发布操作**：
```json
{
  "status": "进行中",
  "suspensionNote": ""
}
```

---

### 场景3：活动永久取消

**操作**：
```json
{
  "status": "draft",
  "suspensionNote": "活动已永久取消（2026-01-27）"
}
```

---

## 🖥️ 后台管理界面

### 状态选择下拉框

```
┌─ 活动状态 ──────────────────┐
│                             │
│  状态： [进行中 ▼]          │
│        • 进行中             │
│        • 草稿 (隐藏)        │
│        • 暂停 (隐藏)        │
│                             │
│  备注说明：                 │
│  [________________]         │
│  (暂停原因、恢复时间等)     │
│                             │
│  [保存更改]                 │
└─────────────────────────────┘
```

---

## 💻 前端实现

### 过滤逻辑

```javascript
/**
 * 获取可见活动列表
 * @param {Array} activities - 所有活动
 * @returns {Array} - 可见活动（仅包含"进行中"状态）
 */
function getVisibleActivities(activities) {
  return activities.filter(activity => activity.status === '进行中');
}

// 使用示例
const visibleActivities = getVisibleActivities(allActivities);
```

### 活动卡片渲染

```jsx
function ActivityList({ activities }) {
  const visibleActivities = activities.filter(a => a.status === '进行中');

  return (
    <div>
      {visibleActivities.map(activity => (
        <ActivityCard key={activity.id} activity={activity} />
      ))}
    </div>
  );
}
```

---

## 📊 示例数据

### 正常活动

```json
{
  "activityNumber": "0008",
  "title": "瑜伽（One Nimman）",
  "status": "进行中",
  "suspensionNote": ""
}
```

### 暂停活动

```json
{
  "activityNumber": "0001",
  "title": "瑜伽（Nong Buak Haad公园）",
  "status": "suspended",
  "suspensionNote": "花卉节期间公园关闭（1月26日-2月15日），预计2月16日恢复"
}
```

### 草稿活动

```json
{
  "activityNumber": "0070",
  "title": "新活动筹备中",
  "status": "draft",
  "suspensionNote": "活动筹备中，预计3月开放"
}
```

---

## 🔄 操作流程

### 暂停活动流程

```
1. 登录后台管理系统
   ↓
2. 找到需要暂停的活动
   ↓
3. 将状态改为 "suspended"
   ↓
4. 填写备注（原因、恢复时间）
   ↓
5. 保存更改
   ↓
6. 前端自动隐藏该活动
```

### 恢复活动流程

```
1. 登录后台管理系统
   ↓
2. 找到暂停的活动（可筛选状态=suspended）
   ↓
3. 将状态改回 "进行中"
   ↓
4. 清空备注
   ↓
5. 保存更改
   ↓
6. 前端自动展示该活动
```

---

## ✅ 方案优势

| 特性 | 优势 |
|------|------|
| **简单** | 只需2个字段，易于理解和维护 |
| **灵活** | 管理员手动控制，无复杂自动化逻辑 |
| **可追溯** | suspensionNote记录暂停原因和时间 |
| **向后兼容** | 不影响现有"进行中"状态 |
| **无需定时任务** | 手动恢复，避免系统复杂度 |

---

## 📝 备注说明规范

### 推荐格式

```
[暂停原因]（[日期范围]），[预计恢复时间]
```

### 示例

- ✅ `"花卉节期间公园关闭（1月26日-2月15日），预计2月16日恢复"`
- ✅ `"装修期间暂停营业（3月1日-3月15日）"`
- ✅ `"雨季暂停，预计11月恢复"`
- ✅ `"活动筹备中，预计3月开放"`

---

## 🗄️ 数据库迁移

### SQL迁移脚本

```sql
-- 添加 suspensionNote 字段
ALTER TABLE activities ADD COLUMN suspensionNote TEXT;

-- 更新现有数据（如有需要）
UPDATE activities
SET suspensionNote = ''
WHERE suspensionNote IS NULL;

-- 创建索引（提升查询性能）
CREATE INDEX idx_activities_status ON activities(status);
```

### MongoDB迁移脚本

```javascript
// migration_add_suspension_note.js
module.exports = {
  async up(db) {
    await db.collection('activities').updateMany(
      { suspensionNote: { $exists: false } },
      { $set: { suspensionNote: "" } }
    );
  },

  async down(db) {
    await db.collection('activities').updateMany(
      {},
      { $unset: { suspensionNote: "" } }
    );
  }
};
```

---

## 🎨 UI/UX 建议

### 后台管理界面

**状态指示器**：
```
进行中  🟢
草稿    🔴 (隐藏)
暂停    🟡 (隐藏)
```

**快速操作**：
```
[一键暂停] → 自动设置status=suspended，提示填写备注
[一键恢复] → 自动设置status=进行中，清空备注
[复制]    → 复制活动到draft状态
```

**筛选功能**：
```
全部活动 | 进行中 | 草稿 | 暂停中
```

---

## 📋 检查清单

### 后台管理系统

- [ ] 状态下拉框包含3个选项：进行中、draft、suspended
- [ ] 备注输入框支持多行文本
- [ ] 保存时验证备注不为空（suspended状态）
- [ ] 活动列表显示状态标签
- [ ] 支持按状态筛选

### 前端展示

- [ ] 过滤掉非"进行中"状态的活动
- [ ] 验证API返回数据包含status字段
- [ ] 测试暂停活动不出现在列表中

### 数据同步

- [ ] JSON文件更新完成
- [ ] Excel文件同步更新（添加status和suspensionNote列）
- [ ] 数据库迁移脚本执行

---

## 🔍 相关字段

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| status | string | 是 | 活动状态：进行中/draft/suspended |
| suspensionNote | string | 否 | 备注说明，suspended状态建议填写 |

---

## 📞 常见问题

### Q1: 为什么不使用published状态？

**A**: 保持向后兼容，现有"进行中"状态无需修改。如需，可将"进行中"理解为published。

### Q2: 暂停活动是否需要保留在数据库中？

**A**: 是的，保留完整数据，只是前端不展示。方便后续恢复和数据追溯。

### Q3: suspensionNote最大长度？

**A**: 建议限制200字符，保持简洁。前端显示时可截断前50字符。

### Q4: 是否需要邮件/通知提醒恢复？

**A**: 当前方案不包含自动提醒，依赖管理员手动操作。如需，可后续添加后台提醒功能。

---

**文档版本**：v1.0
**最后更新**：2026-01-27
**方案状态**：✅ 已确认并实施
